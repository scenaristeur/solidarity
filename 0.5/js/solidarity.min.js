var gblVersion="0.5a",Solidarity={},sol=Solidarity,sh={},g={w:-1,h:-1,device:{isMobile:!1,isTablet:!1,isPC:!1},preferences:{date_format:1,sounds:!1},state:{bFirstRunSession:!1,isSplashScreen:!0,pc_tab_bar_main:1,pc_tab_bar_main_condensed:1,pc_tab_bar_main_right:1},solid:{sh:{},pod:{},session:{},pti:{},name:"",photo:"",friends:{},role:{},storage:{},inbox:{},isLogged:!1,webId:"",instances:{longchat:"",chat:""}},date:{day:"",month:"",year:""},active_channel:{sh:{},pod:{},pti:{},name:"",photo:"",friends:{},
role:{},storage:{},long_chat_instance:{},chat:{},chat_pages:{},chat_massages:{},long_chat_instance_isPrivate:!1},favourite_channels:{selected:0,list:[{channel_name:"Solidarity",channel_url:"https://solidarity.inrupt.net"},{channel_name:"Shighl/Shighl",channel_url:"https://solidarity.inrupt.net"}]}},UIX={Mobile:{BurgerMenuShow:function(){TweenMax.to($("#mobile_burger_menu_slideout"),.25,{width:g.w,delay:.5})},UserMenuShow:function(){},MainMenuShow:function(){}}};
function clone(a){return $.extend({},a)}function trace(a){console.log(a)}function setScrollerToBottom(a){a=document.getElementById(a);a.scrollTop=a.scrollHeight}function padLeadingZero(a){return 10>a?"0"+a:a}function openwindow(a){return(a=window.open(a,"_blank"))?(a.focus(),!0):!1}function crypto_getSHA1Hash(a){var b=new jsSHA("SHA-1","TEXT");b.update(a);return b.getHash("HEX")}
function crypto_vernam(a,b){var c=b.length,d=String.fromCharCode;return a.replace(/[\s\S]/g,function(a,f){return d(b.charCodeAt(f%c)^a.charCodeAt(0))})}function string__getURLPath(a){return a.match(/(https?:\/\/[^\s]+)/g)}function string__getTextFromTextAndURL(a){return a.replace(/(https?:\/\/[^\s]+)/g,function(a){return""})}
function string__isYouTubeLink(a){return-1!==a.indexOf("https://www.youtube.com/watch?v=")?"https://www.youtube.com/embed/"+a.split("https://www.youtube.com/watch?v=").join("")+"?controls=0":!1}function string__isImageLink(a){a=a.toLowerCase();var b=1<a.split(".jpg").length?!0:!1,c=1<a.split(".png").length?!0:!1,d=1<a.split(".gif").length?!0:!1;return b||c||d?a:!1}function string__urlify(a){return a.replace(/(https?:\/\/[^\s]+)/g,function(a){return'<a href="'+a+'">'+a+"</a>"})}
String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.contains=function(a){return-1!==this.indexOf(a)};String.prototype.searchAndReplace=function(a,b){return this.split(a).join(b)};
var Templates={Item:{name:"",value:""},template_list:[],Create:function(a){try{this.template_list.push({name:a.name,value:$(a.value).comments().html().toString()})}catch(b){trace("TEMPLATE ERROR! "+a.name)}},Get:function(a){for(var b=0;b<this.template_list.length;b++)if(this.template_list[b].name===a)return this.template_list[b].value;return!1},GetWithReplace:function(a,b){for(var c=0;c<this.template_list.length;c++)if(this.template_list[c].name===a){a=this.template_list[c].value;for(c=0;c<b.length;c++)a=
a.searchAndReplace(b[c].search,b[c].replace);return a}}};function List(){this.items=[];this.add=function(a){this.items.push(a)};this.length=function(){return this.items.length};this.addUnique=function(a){for(var b=!1,c=0,d=0;d<this.items.length;d++)this.items[d].name==a.name&&(b=!0,c++);if(1==b)return c;this.items.push(a);return!1};this.remove=function(a){var b=!1;a=this.items.indexOf(a);-1<a&&(b=!0,this.items.splice(a,1));return b}}
Solidarity={Responsive:{ArrangeViewport:function(){g.device.isPC&&($("#uix_baseframe_banner_tr").css("left",g.w-49),$("#uix_baseframe_banner_bm").css("width",g.w-51),$("#uix_baseframe_banner_rh").css("left",g.w-26),$("#uix_baseframe_banner_lh").css("height",g.h-49),$("#uix_baseframe_banner_rh").css("height",g.h-49),$("#uix_baseframe_frame_bl").css("top",g.h-47),$("#uix_baseframe_frame_br").css("top",g.h-47).css("left",g.w-48),$("#uix_baseframe_frame_bm").css("top",g.h-25),$("#div_main_tab_burger").css("left",
g.w-80),$("#div_chatviewportbg").css("height",g.h-190).css("width",g.w-258),$("#div_chatter_container").css("width",g.w-267).css("height",g.h-280),$("#div_inputconsole__loggedin__avatar_container").css("left",225).css("top",g.h-110),$("#div_chatviewport_inputconsole").css("top",g.h-120).css("width",g.w-343),$("#modal_preferences").css("width",400),g.state.isSplashScreen&&($("#div_index_splash_pc").css("display","inline"),$("#div_index_splash_tab").css("display","none"),$("#div_index_splash_mob").css("display",
"none")));g.device.isTablet&&($("#div_mob_chatviewportbg").css("width",g.w).css("height",g.h-40),$("#div_mob_chatter_container").css("width",g.w).css("height",g.h-120),$("#div_mob_inputconsole__loggedin__avatar_container").css("left",5).css("top",g.h-50+3),$("#div_mob_chatviewport_inputconsole").css("top",g.h-65).css("width",g.w-41),$("#modal_preferences").css("width",300),g.state.isSplashScreen&&($("#div_index_splash_pc").css("display","none"),$("#div_index_splash_tab").css("display","inline"),$("#div_index_splash_mob").css("display",
"none")));g.device.isMobile&&($("#div_mob_chatviewportbg").css("width",g.w).css("height",g.h-40),$("#div_mob_chatter_container").css("width",g.w).css("height",g.h-120),$("#div_mob_inputconsole__loggedin__avatar_container").css("left",5).css("top",g.h-50+3),$("#div_mob_chatviewport_inputconsole").css("top",g.h-65).css("width",g.w-41),$("#modal_preferences").css("width",300),g.state.isSplashScreen&&($("#div_index_splash_pc").css("display","none"),$("#div_index_splash_tab").css("display","none"),$("#div_index_splash_mob").css("display",
"inline")))},DeviceView:function(){0<g.w&737>g.w&&(g.device.isPC=!1,g.device.isTablet=!1,g.device.isMobile=!0,$("#div_pc").css("display","none"),$("#div_tab").css("display","none"),$("#div_mob").css("display","inline"));736<g.w&1068>g.w&&(g.device.isPC=!1,g.device.isTablet=!0,g.device.isMobile=!1,$("#div_pc").css("display","none"),$("#div_tab").css("display","none"),$("#div_mob").css("display","inline"));1067<g.w&&(g.device.isPC=!0,g.device.isTablet=!1,g.device.isMobile=!1,$("#div_pc").css("display",
"inline"),$("#div_tab").css("display","none"),$("#div_mob").css("display","none"))}}};window.onresize=function(){g.w=$(window).width();g.h=$(window).height();Solidarity.Responsive.DeviceView();Solidarity.Responsive.ArrangeViewport()};Templates.template_list.push({name:"ListSimple",value:'<p>@lbl_header@</p><ul id="@ID@" style="list-style-type:none;">@BODY@</ul><p>@lbl_footer@</p><div><button onclick="javascript:@INSTANCE@_add();" type="button">Add</button><button onclick="javascript:@INSTANCE@_edit();" type="button">Edit</button><button onclick="javascript:@INSTANCE@_remove();" type="button">remove</button></div>'});
Templates.template_list.push({name:"ListSimple_Item",value:'<li onclick="javascript:@INSTANCE@__onClick(@ID@)" style="cursor:pointer;" >@lbl_item@</li>'});Templates.template_list.push({name:"ListSimple_Item_Style_Radio",value:'<li onclick="javascript:@INSTANCE@__onClick(@ID@)" style="cursor:pointer;"><input id="@INSTANCE@__item@ID@" type="radio">@lbl_item@</li>'});Templates.template_list.push({name:"ListSimple_Item_Style1",value:'<li onclick="javascript:@INSTANCE@__onClick(@ID@)" style="cursor:pointer;" >@lbl_item@</li>'});
Templates.template_list.push({name:"ListSimple_Input",value:'<p><input type="text" name="@tf_item@">:item</p>'});Templates.template_list.push({name:"Chatter_Item",value:'<div id="divviewportpcbg_@GUID@" class="@CLASS@"  style="position:relative; width:98%; height:auto; background-color:#dedede-"><div id="divviewportpcavatar_@GUID@" class="@CLASS@" style="position:absolute; left:22px; top:8px; width:29px; height:29px; background-image:url(\'images/no-avatar.png\'); background-size:contain; opacity:.3"></div><div id="divviewportpcavatar_@GUID@" class="@CLASS@" style="position:absolute; left:22px; top:8px; width:29px; height:29px; background-image:url(\'@AVATAR@\'); background-size:contain;"> </div><div id="divviewportpcname_@GUID@" class="@CLASS@"  style="position:absolute; left:60px; top:4px; width:auto; height:auto;  text-align:left;"><font face="Roboto" style="color:#855FFA; font-size:13px;font-weight:700"><span id="@LBL_ID@">@LBL_NAME@</span></font></div><div id="divviewportpcmsg_@GUID@" class="@CLASS@"  style="position:relative; padding-left:61px; padding-top:21px; padding-bottom: 5px; width:70%; height:auto;  text-align:left;"><font face="Roboto" style="color:#303030; font-size:13px; font-weight:400"><span id="@LBL_ID@">@LBL_CONTENT@</span></font></div><div id="divviewportpctime_@GUID@" class="@CLASS@"  style="float:right; margin-top:-40px; width:190px; height:auto;  opacity:.5; text-align:left;"><font face="Roboto" style="color:#A5A5A5; font-size:13px;font-weight:bold;"><span id="@LBL_ID@">@LBL_TIME@</span></font></div><div id="divviewportpcburger_@GUID@" style="float:right; margin-top:-40px; margin-right:0px; text-align:right;"><div class="ui simple dropdown item"><i class="bars icon" style="color:#333333 !important; margin-top:0px;"></i><div class="menu" style="margin-left:-105px !important;"><div class="item" onclick="_()">!Quote</div><div class="item" onclick="_()">!Bookmark</div><div class="item" onclick="_()">!Mark as Topic</div><div class="item" onclick="_()">!Mark as Question</div><div class="item" onclick="_()">!Flag</div></div></div></div><div style="position:absolute; left:22px; top:8px; width:29px; height:29px;"><div class="avatar" style="width:29px; height:29px; background-color:#800000-"></div><div class="ui special popup"><div class="ui card"><div class="image"><img src="@AVATAR@"></div><div class="content"><a class="header">@LBL_NAME@</a><div class="meta"><a href="@LBL_WEBID@" target="_blank"><span style="font-size:12px;">@LBL_WEBID@</span></a></div></div></div></div></div></div></div>'});
Templates.template_list.push({name:"Chatter_Item_mob",value:'<div id="divviewportpcbg_@GUID@" class="@CLASS@"  style="position:relative; width:98%; height:auto; background-color:#dedede-"><div id="divviewportpcavatar_@GUID@" class="@CLASS@" style="position:absolute; left:0px; top:8px; width:29px; height:29px; background-image:url(\'images/no-avatar.png\'); background-size:contain; opacity:.3"></div><div id="divviewportpcavatar_@GUID@" class="@CLASS@" style="position:absolute; left:0px; top:8px; width:29px; height:29px; background-image:url(\'@AVATAR@\'); background-size:contain;"> </div><div id="divviewportpcname_@GUID@" class="@CLASS@"  style="position:absolute; left:35px; top:4px; width:auto; height:auto;  text-align:left;"><font face="Roboto" style="color:#855FFA; font-size:13px;font-weight:700"><span id="@LBL_ID@">@LBL_NAME@</span></font></div><div id="divviewportpcmsg_@GUID@" class="@CLASS@"  style="position:relative; padding-left:36px; padding-top:23px; padding-bottom: 5px; width:90%; height:auto;  text-align:left;"><font face="Roboto" style="color:#303030; font-size:11px; font-weight:400"><span id="@LBL_ID@">@LBL_CONTENT@</span></font><font face="Roboto" style="color:#C5C5C5; font-size:11px;font-weight:normal;"><span id="@LBL_ID@">@LBL_TIME@</span></font></div><div id="divviewportpcburger_@GUID@" style="float:right; margin-top:-40px; margin-right:-10px; text-align:right;"><div class="ui simple dropdown item"><i class="bars icon" style="color:#333333 !important; margin-top:0px;"></i><div class="menu" style="margin-left:-135px !important;"><div class="item" onclick="_()">!Quote</div><div class="item" onclick="_()">!Bookmark</div><div class="item" onclick="_()">!Mark as Topic</div><div class="item" onclick="_()">!Mark as Question</div><div class="item" onclick="_()">!Flag</div></div></div></div><div style="position:absolute; left:22px; top:8px; width:29px; height:29px;"><div class="avatar" style="width:29px; height:29px; background-color:#800000-"></div><div class="ui special popup"><div class="ui card"><div class="image"><img src="@AVATAR@"></div><div class="content"><a class="header">@LBL_NAME@</a><div class="meta"><a href="@LBL_WEBID@" target="_blank"><span style="font-size:12px;">@LBL_WEBID@</span></a></div></div></div></div></div></div></div>'});
function Mannequin(){this.ListSimple=function(a){this.types={type_label:1,type_radio:2,type_checkbox:3};this._pattern=this.types.type_checkbox;this._data={_items:[],_parent:"",_selected:-1,_selected_items:[],_disabled_items:[],_disabled:!1,_max:1E3,_min:0};this.onDraw;this.add=function(a){this._data._items.push(a);this._data._selected=this._data._items.length-1;if(this.onRenderItem)this.onRenderItem(a)};this.remove=function(){};this.edit=function(){};this.delete=function(){};this.init=function(){};
this.draw=function(){var a={_parent:this._data._parent,_items:this._data._items,_this:this};if(this.onDraw)this.onDraw(a);else{for(var c="",d=0;d<a._items.length;d++){var e=Templates.Get("ListSimple_Item_Style_Radio");e=e.searchAndReplace("@lbl_item@",a._items[d].label);e=e.searchAndReplace("@INSTANCE@",g.m_todolist._data._parent);e=e.searchAndReplace("@ID@",d);c+=e}c=Templates.GetWithReplace("ListSimple",[{search:"@lbl_header@",replace:"This is our shopping list."},{search:"@lbl_footer@",replace:"You have "+
a._items.length+" items in your shopping list."},{search:"@INSTANCE@",replace:g.m_todolist._data._parent},{search:"@BODY@",replace:c}]);$("#"+a._parent).html(c)}};this.saveToSession=function(){};this.saveToLocal=function(){};this.saveToServer=function(){}}}var manne=new Mannequin;
async function Pod(a){this.sh=new Shighl;this.pod=new sh.pod;this.pod.webId=a;this.name=await pod.name;this.photo=await pod.photo;this.friends=await pod.friends;this.pti=await pod.pti;this.role=await pod.role;this.storage=await pod.storage}
function init(){function a(a){console.log("WebId: ",a);null!=a?(console.log("Already Logged in as "+a),g.solid.isLogged=!0,g.solid.webId=a,g.solid.pod.webId=a,solid_login__getNameAndPhoto()):g.solid.session.login()}trace(" **********************************************");trace(" S O L I D A R I T Y     Version "+gblVersion);trace(" **********************************************");$(".tabular.menu .item").tab({history:!1});$.tab("change tab","tab_chatter");$(".ui.checkbox").checkbox();g.device.isPC&&
$("#div_index_splash_pc").css("display","inline");g.device.isTablet&&$("#div_index_splash_mob").css("display","inline");g.device.isMobile&&$("#div_index_splash_mob").css("display","inline");var b=showdown.getDefaultOptions();trace(b);showdown.setOption("ghMentions","true");showdown.setOption("emoji","true");showdown.setOption("tasklists","true");g.solid.sh=new Shighl;g.solid.session=new g.solid.sh.session;g.solid.pod=new g.solid.sh.pod;b=g.solid.sh.version;$("#sp_lblSplashVersion").html("v&nbsp;"+
gblVersion+" / "+(null==b?"n/a":b));$("#sp_lblSplashVersionTab").html("v&nbsp;"+gblVersion+" / "+(null==b?"n/a":b));$("#sp_lblSplashVersionMob").html("v&nbsp;"+gblVersion+" / "+(null==b?"n/a":b));(async function(){await g.solid.session.track(a)})();$("#div_chatter_container").scroll(function(){0==$("#div_chatter_container").scrollTop()&&trace("top fo scroller")});$("#div_mob_chatter_container").scroll(function(){0==$("#div_chatter_container").scrollTop()&&trace("top fo scroller")});solid_channel__attachAddNewChannelTextfieldEvents();
b=new Date;g.date.day=padLeadingZero(b.getDate())+"";g.date.month=padLeadingZero(b.getMonth()+1)+"";g.date.year=b.getFullYear()+"";trace("Year-Month-Day: "+g.date.year+"-"+g.date.month+"-"+g.date.day);window.sfx_new_chat=new Howl({src:["audio/Pling-KevanGC-1485374730.mp3"]});$("#ta_preferences_private_key").val("");b=new JSEncrypt;b.setKey("");var c=b.encrypt("test");b.decrypt(c);console.log("*****************************************************************************");console.log(c);console.log("*****************************************************************************");
cookie.get("fBoot")?(g.favourite_channels=JSON.parse(cookie.get("Channels")),g.preferences=JSON.parse(cookie.get("Preferences"))):(cookie.set("fBoot",!0),cookie.set("Channels",JSON.stringify(g.favourite_channels)),cookie.set("Preferences",JSON.stringify(g.preferences)));solid_channels__displayFavouriteChannels();solid_long_chat__setChannel(g.favourite_channels.list[g.favourite_channels.selected].channel_url,g.favourite_channels.list[g.favourite_channels.selected].channel_name)}
function init__splash_enterClicked(){g.state.isSplashScreen=!1;$("#div_index_splash_pc").css("display","none");$("#div_index_splash_tab").css("display","none");$("#div_index_splash_mob").css("display","none")}function div_todolist_add(){alert("add clicked!")}
function div_todolist__onClick(a){for(var b=0;b<g.m_todolist._data._items.length;b++)$("#"+g.m_todolist._data._parent+"__item"+b).prop("checked",!1);$("#"+g.m_todolist._data._parent+"__item"+a).prop("checked",!0);g.m_todolist._data._selected=a}function navigation__chatterModeClicked(){}function navigation_tabs_onclick(a){}function navigation__findOutMore(){openwindow("https://github.com/scenaristeur/solidarity")}
function solid_login__ShowAsLoggedIn(a,b){$("#div_banner__account__loggedin__name").html(b);null!=a?($("#div_banner__account__loggedin__avatar").css("background-image","url('"+a+"')"),$("#div_inputconsole__loggedin__avatar").css("background-image","url('"+a+"')"),$("#div_tab_banner__account__loggedin__avatar").css("background-image","url('"+a+"')"),$("#div_tab_inputconsole__loggedin__avatar").css("background-image","url('"+a+"')"),$("#div_mob_banner__account__loggedin__avatar").css("background-image",
"url('"+a+"')"),$("#div_mob_inputconsole__loggedin__avatar").css("background-image","url('"+a+"')")):($("#div_banner__account__loggedin__avatar").css("background-image","url('images\no-avatar.png')"),$("#div_inputconsole__loggedin__avatar").css("background-image","url('images\no-avatar.png')"),$("#div_tab_banner__account__loggedin__avatar").css("background-image","url('images\no-avatar.png')"),$("#div_tab_inputconsole__loggedin__avatar").css("background-image","url('images\no-avatar.png')"),$("#div_mob_banner__account__loggedin__avatar").css("background-image",
"url('images\no-avatar.png')"),$("#div_mob_inputconsole__loggedin__avatar").css("background-image","url('images\no-avatar.png')"));$("#div_banner__account__loggedout").css("display","none");$("#div_tab_banner__account__loggedout").css("display","none");$("#div_mob_banner__account__loggedout").css("display","none");$("#div_banner__account__loggedin").css("display","inline");$("#div_tab_banner__account__loggedin").css("display","inline");$("#div_mob_banner__account__loggedin").css("display","inline");
$("#div_inputconsole__loggedin__avatar_container").css("display","inline");$("#div_tab_inputconsole__loggedin__avatar_container").css("display","inline");$("#div_mob_inputconsole__loggedin__avatar_container").css("display","inline")}
function solid_login__ShowAsLoggedOut(){$("#div_banner__account__loggedin__name").html("");$("#div_banner__account__loggedin__avatar").css("background-image","url('')");$("#div_banner__account__loggedin").css("display","none");$("#div_banner__account__loggedout").css("display","inline");$("#div_mob_banner__account__loggedin__name").html("");$("#div_mob_banner__account__loggedin__avatar").css("background-image","url('')");$("#div_mob_banner__account__loggedin").css("display","none");$("#div_mob_banner__account__loggedout").css("display",
"inline");$("#div_inputconsole__loggedin__avatar_container").css("display","none");$("#div_mob_inputconsole__loggedin__avatar_container").css("display","none")}async function solid_login__getNameAndPhoto(){trace("solid_login__getNameAndPhoto() -> FIRED!");g.solid.photo=await g.solid.pod.photo;g.solid.name=await g.solid.pod.name;solid_login__ShowAsLoggedIn(g.solid.photo,g.solid.name)}async function solid_login__login(){console.log("trying to login..");g.solid.session.login()}
async function solid_login__logout(){trace("solid_login__logout() -> FIRED!");g.solid.session.logout();g.solid.isLogged=!1;solid_login__ShowAsLoggedOut()}
async function solid_long_chat__getPublicTypeIndex(a,b,c){console.log("Trying to retrieve PublicTypeInstance for "+a);g.active_channel.sh=new Shighl;g.active_channel.pod=new g.active_channel.sh.pod;g.active_channel.pod.webId=a;g.active_channel.pti=await g.active_channel.pod.pti;trace(g.active_channel.pti);var d=b+"/public/"+c+"/index.ttl#this",e=b+"/private/"+c+"/index.ttl#this",f=!1;console.log("Searching for Long-chat channel: "+d+" in the public type index");g.active_channel.pti.instances.forEach(function(a){trace("searching PTI for.. "+
d);trace(a);"LongChat"==a.shortClass&(a.url==d|a.url==e)&&(a.url==e?(trace("This chat is PRIVATE"),g.active_channel.long_chat_instance_isPrivate=!0):(trace("This chat is PUBLIC"),g.active_channel.long_chat_instance_isPrivate=!1),console.log("Found Target long-chat CHANNEL"),f=a,g.active_channel.long_chat_instance=a)});console.log(f);solid_long_chat__initLongChatInstance(!1)}
async function solid_long_chat__initLongChatInstance(a){a||(g.active_channel.chat=new g.active_channel.sh.chat,g.active_channel.chat.instance=g.active_channel.long_chat_instance,g.active_channel.chat_pages=await g.active_channel.chat.init,g.active_channel.chat.subscribe=solid_long_chat__subscribe_onReceivedMessage,trace("chat.init -> Called!"),trace(g.active_channel.chat_pages));g.active_channel.chat_massages=await g.active_channel.chat.messages;trace(g.active_channel.chat_massages);a=new showdown.Converter;
var b="";$("#div_chatter_container").html("");for(var c=0;c<g.active_channel.chat_massages.length;c++){var d=g.active_channel.chat_massages[c];trace(d);var e="";void 0!=d.maker&&(g.device.isPC&&(e=Templates.Get("Chatter_Item")),g.device.isMobile|g.device.isTablet&&(e=Templates.Get("Chatter_Item_mob")),"undefined"!=d.makerimg?e=e.searchAndReplace("@AVATAR@",d.makerimg):e=e.searchAndReplace("@AVATAR@","images/no-avatar.png"),e=e.searchAndReplace("@AVATAR@",d.makerimg),e=e.searchAndReplace("@LBL_NAME@",
d.makername),e=e.searchAndReplace("@LBL_WEBID@",d.maker),e=e.searchAndReplace("@LBL_CONTENT@",a.makeHtml(d.content)),e=e.searchAndReplace("@LBL_TIME@",0==g.preferences.date_format?jQuery.timeago(new Date(d.date)):moment(new Date(d.date)).add(24,"hours").format("MMM Do YYYY, h:mm a")),b+=e)}g.device.isPC&&$("#div_chatter_container").html("<div style='margin-top:0px'></div>"+b+"<div style='margin-top:25px'></div>");g.device.isMobile|g.device.isTablet&&$("#div_mob_chatter_container").html("<div style='margin-top:0px'></div>"+
b+"<div style='margin-top:25px'></div>");0==g.state.bFirstRunSession?g.state.bFirstRunSession=!0:g.preferences.sounds&&window.sfx_new_chat.play();$(".avatar").popup({inline:!0,hoverable:!0,delay:{show:0,hide:2E3}});setScrollerToBottom("div_chatter_container")}function solid_long_chat_reply__onEnterCheck(){return 13===window.event.keyCode?(trace("ENTER Pressed!"),solid_long_chat__sendMessage(),!1):!0}
async function solid_long_chat__sendMessage(){trace("solid_long_chat__sendMessage() -> FIRED!");var a="";if(g.solid.isLogged){g.device.isPC&&(a=$("#frm_lc_text_input").val().trim(),$("#frm_lc_text_input").val(""),$("#frm_lc_text_input").blur());g.device.isTablet&&(a=$("#frm_tab_lc_text_input").val().trim(),$("#frm_tab_lc_text_input").val(""),$("#frm_tab_lc_text_input").blur());g.device.isMobile&&(a=$("#frm_mob_lc_text_input").val().trim(),$("#frm_mob_lc_text_input").val(""),$("#frm_mob_lc_text_input").blur());
var b=g.active_channel.chat_massages[g.active_channel.chat_massages.length-1],c=b.url;b=b.maker;g.active_channel.chat.message={content:a,webId:g.solid.webId,postType:"InstantMessage",replyTo:c};if(0<b.length){console.log("author",b);trace("--------------------------------");trace("replyTo="+c);trace(" author="+b);trace("postType=InstantMessage");trace("--------------------------------");a=g.active_channel.chat.lastPost;let d=g.solid.sh.pod();console.log("pod",d);d.webId=b;console.log("pod",d);b=new sh.inbox;
b.inbox=await d.inbox;console.log("ib",b);b.message={sender:g.solid.webId,title:"solidarity reply",url:a,content:a+" is a InstantMessage reply to' "+c,replyTo:c}}}else alert("you must be logged into your Solid account to send messages!!")}function solid_long_chat__subscribe_onReceivedMessage(){solid_long_chat__initLongChatInstance(!0)}
function solid_long_chat__setChannel(a,b){trace("!!!!! ONLY BE CALLED ONCE!!!!!!  solid_long_chat__setChannel() -> FIRED!");solid_long_chat__getPublicTypeIndex(a+"/profile/card#me",a,b)}Solidarity.Friends={Get:function(a){(async function(){return await sh.getFriends(a)})()}};
var solid_rdf_store=$rdf.graph(),solid_rdf_fetcher=new $rdf.Fetcher(solid_rdf_store),solid_rdf_updater=new $rdf.UpdateManager(solid_rdf_store),me_uri="https://julian-cole.inrupt.net/profile/card#me",doc=solid_rdf_store.sym("https://julian-cole.inrupt.net/profile/card#me").doc(),solid={_rdf_Namespace:{FOAF:$rdf.Namespace("http://xmlns.com/foaf/0.1/"),VCARD:$rdf.Namespace("http://www.w3.org/2006/vcard/ns#")},_popupLoginUri:"https://solid.github.io/solid-auth-client/dist/popup.html",_fc:SolidFileClient,
_logged:!1,_webId:"",_btn_login:"#login",_btn_logout:"#logout",checkSession_opts:{ENABLE_LOGGING:!1,AUTO_TOGGLE_BUTTONS:!0,AUTO_POLL_SESSION:!0,CALLBACK:function(){}},checkSession:function(){this._fc.checkSession().then(function(a){solid._logged=!0;solid._webId=a.webId;solid.checkSession_opts.AUTO_TOGGLE_BUTTONS&&($(solid._btn_login).toggle(!1),$(solid._btn_logout).toggle(!0));solid.checkSession_opts.ENABLE_LOGGING&&console.log("success! logged in as: "+a.webId);solid.checkSession_opts.CALLBACK&&
solid.checkSession_opts.CALLBACK({success:!0,webId:a.webId});return a.webId}).catch(function(a){solid.checkSession_opts.AUTO_TOGGLE_BUTTONS&&($(solid._btn_login).toggle(!0),$(solid._btn_logout).toggle(!1));solid.checkSession_opts.ENABLE_LOGGING&&console.log(a);solid.checkSession_opts.CALLBACK&&solid.checkSession_opts.CALLBACK({success:!1,webId:!1,error:a})})},login_opts:{ENABLE_LOGGING:!1,SILENT:!1},login:function(a){0==solid.login_opts.SILENT&&this._fc.popupLogin().then(function(b){console.log("success! logged in as: "+
b);a&&a(b)}).catch(function(a){console.log(a)})},logout:function(){this._fc.logout().then(function(){console.log("Bye now!");solid._logged=!1;$(solid._btn_login).toggle(!0);$(solid._btn_logout).toggle(!1)}).catch(function(a){console.log("Error! "+a)})},getProfile_mappings:[{ns:"http://www.w3.org/2006/vcard/ns#",name:"fn",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"hasAddress",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"hasEmail",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",
name:"hasPhoto",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"hasTelephone",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"note",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"organization-name",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"role",value:""},{ns:"http://www.w3.org/ns/ldp#",name:"inbox",value:""},{ns:"http://www.w3.org/ns/pim/space#",name:"preferencesFile",value:""},{ns:"http://www.w3.org/ns/pim/space#",name:"storage",value:""},{ns:"http://www.w3.org/ns/solid/terms#",
name:"account",value:""},{ns:"http://www.w3.org/ns/solid/terms#",name:"privateTypeIndex",value:""},{ns:"http://www.w3.org/ns/solid/terms#",name:"publicTypeIndex",value:""},{ns:"http://xmlns.com/foaf/0.1/",name:"name",value:""}],getProfile:function(a,b){solid_rdf_fetcher.load(a).then(function(){for(var c=clone(solid.getProfile_mappings),d=0;d<solid.getProfile_mappings.length;d++){var e=$rdf.Namespace(solid.getProfile_mappings[d].ns);try{c[d].value=solid_rdf_store.any($rdf.sym(a),e(solid.getProfile_mappings[d].name)).value}catch(f){c[d].value=
""}}b&&b(c);return c}).catch(function(a){console.log(a)})},getFriends_mappings:[{ns:"http://www.w3.org/2006/vcard/ns#",name:"fn",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"hasAddress",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"hasEmail",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"hasPhoto",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"hasTelephone",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"note",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",
name:"organization-name",value:""},{ns:"http://www.w3.org/2006/vcard/ns#",name:"role",value:""},{ns:"http://www.w3.org/ns/ldp#",name:"inbox",value:""},{ns:"http://www.w3.org/ns/pim/space#",name:"preferencesFile",value:""},{ns:"http://www.w3.org/ns/pim/space#",name:"storage",value:""},{ns:"http://www.w3.org/ns/solid/terms#",name:"account",value:""},{ns:"http://www.w3.org/ns/solid/terms#",name:"privateTypeIndex",value:""},{ns:"http://www.w3.org/ns/solid/terms#",name:"publicTypeIndex",value:""},{ns:"http://xmlns.com/foaf/0.1/",
name:"name",value:""}],getFriends_profile_uris:[],getFriendsCount:0,getFriends_list:[],getFriends:function(a,b){solid.getFriends_list=[];solid_rdf_fetcher.load($rdf.sym(a),solid._rdf_Namespace.FOAF("knows")).then(function(){var a=solid_rdf_store.each($rdf.sym(solid._webId),solid._rdf_Namespace.FOAF("knows"));solid.getFriendsCount=a.length;trace("You have "+solid.getFriendsCount+" friend"+(1==solid.getFriendsCount?"":"s"));for(var d=0;d<a.length;d++)solid.getFriends_profile_uris.push({uri:a[d]}),solid.getProfile(a[d],
function(a){solid.getFriends_list.push(a)});if(b)b(solid.getFriends_list);else return solid.getFriends_list}).catch(function(a){console.log("error getting friends! "+a)})},createFolder:function(a,b){solid._fc.createFolder(a,b).then(function(){b&&b()}).catch(function(a){console.log(a)})},deleteFolder:function(a,b){trace("deleteFolder() -> FIRED!"+a);solid._fc.deleteFolder(a,b).then(function(){b&&b()}).catch(function(a){console.log(a)})},readFolder:function(a,b){solid._fc.readFolder(a,b).then(function(a){if(b)b(a);
else return a}).catch(function(a){console.log(a)})},copyFolder:function(a,b,c){solid._fc.copyFolder(a,b).then(function(a){if(c)c(a);else return a}).catch(function(a){console.log(a)})},createFile:function(a,b){solid._fc.createFile(a,"","",b).then(function(a){if(b)b(a);else return a}).catch(function(a){console.log(a)})},readFile:function(a,b){solid._fc.readFile(a,b).then(function(a){if(b)b(a);else return a}).catch(function(a){console.log(a)})},updateFile:function(a,b,c,d){solid._fc.updateFile(a,b,c,
d).then(function(){d&&d()}).catch(function(a){console.log(a)})},copyFile:function(a,b,c){solid._fc.copyFile(a,b,c).then(function(){c&&c()}).catch(function(a){console.log(a)})},deleteFile:function(a,b){solid._fc.deleteFile(a,b).then(function(c){if(b)b(a);else return a}).catch(function(a){console.log(a)})},fetchAndParse:function(a,b,c){solid._fc.deleteFile(a,b,c).then(function(a){if(c)c(a);else return a}).catch(function(a){console.log(a)})}};
function solid_channels__displayFavouriteChannels(){trace("solid_channels__displayFavouriteChannels() -> FIRED!");for(var a="",b="",c=0;c<g.favourite_channels.list.length;c++)a=a+"<span onclick=\"javascript:solid_channels__changeChannels('"+c+'\')" style="cursor:pointer;color:'+(c==g.favourite_channels.selected?"#855FFA":"#000000")+"; font-size:14px; font-weight:"+(c==g.favourite_channels.selected?"bold":"normal")+';">'+g.favourite_channels.list[c].channel_name+'</span><br><div style="width:40px;height:2px"></div>',
b=b+'<div class="item" onclick="solid_channels__removeFavouriteChannel('+c+')" style="font-size:16px;cursor:pointer;">'+g.favourite_channels.list[c].channel_name+'<i class="times circle icon" style="color:red; margin-left:5px; margin-top:0px"></i></div>';$("#div_pc_channel_list").html(a);$("#div_remove_favourite_channel_list").html(b);$("#lbl_channel_count").html(" ("+g.favourite_channels.list.length+")")}
function solid_channels__changeChannels(a){trace("solid_channels__changeChannels() -> FIRED!"+a);g.favourite_channels.selected=a;solid_channels__displayFavouriteChannels();solid_long_chat__setChannel(g.favourite_channels.list[g.favourite_channels.selected].channel_url,g.favourite_channels.list[g.favourite_channels.selected].channel_name)}
function solid_channels__addChannels(a,b){trace("solid_channels__addChannels() -> FIRED!, "+a+", "+b);g.favourite_channels.list.push({channel_name:a,channel_url:b});solid_channels__displayFavouriteChannels();cookie.set("Channels",JSON.stringify(g.favourite_channels));$("#div_remove_channel").css("display","inline")}
function solid_channels__removeFavouriteChannel(a){trace("solid_channels__removeFavouriteChannel() -> FIRED!"+a);g.favourite_channels.list.splice(a,1);0==g.favourite_channels.list.length?(g.favourite_channels.selected=0,$("#div_pc_channel_list").html(""),$("#div_remove_favourite_channel_list").html(""),$("#div_remove_channel").css("display","none")):(g.favourite_channels.selected==a?g.favourite_channels.selected=0:g.favourite_channels.selected--,solid_channels__displayFavouriteChannels());cookie.set("Channels",
JSON.stringify(g.favourite_channels))}function solid_channel__attachAddNewChannelTextfieldEvents(){$("#frm_add_channel_name").focusout(function(){solid_channels__onEnterCheck(1)});$("#frm_add_channel_url").focusout(function(){solid_channels__onEnterCheck(2)})}function solid_channels__onEnterCheck(a){return 13===window.event.keyCode?(""!=$("#frm_add_channel_url").val().trim()&""!=$("#frm_add_channel_name").val().trim()&&solid_channels__checkChatExists(),!1):!0}
function solid_channels__checkChatExists(){function a(a){trace("checkChatFolderContents() -> FIRED!");trace(a);a.files[0].name="chat.ttl";trace("CHAT FOUND!");$("#div_modal_add_channel_validating").css("display","none");$("#div_modal_add_channel_success").css("display","inline-block")}function b(b){trace("checkChatFolderDays() -> FIRED!");trace(b);for(var c=0;c<b.folders.length;c++)h.push(b.folders[c].name);h.reverse();solid.readFolder(d+"/"+e[0]+"/"+f[0]+"/"+h[0],a)}function c(a){trace("checkChatFolderMonth() -> FIRED!");
trace(a);for(var c=0;c<a.folders.length;c++)f.push(a.folders[c].name);f.reverse();solid.readFolder(d+"/"+e[0]+"/"+f[0],b)}trace("solid_channels__checkChatExists() -> FIRED!");$("#div_modal_add_channel_validating").css("display","inline-block");$("#div_modal_add_channel_success").css("display","none");var d=$("#frm_add_channel_url").val().trim()+"/public/"+$("#frm_add_channel_name").val().trim().split(" ").join(""),e=[],f=[],h=[];solid.readFolder(d,function(a){trace("checkChatFolderYear() -> FIRED!");
trace(a);for(var b=0;b<a.folders.length;b++)e.push(a.folders[b].name);e.reverse();solid.readFolder(d+"/"+e[0],c)})}
function modals__add_channel_show(){$("#div_modal_add_channel_validating").css("display","none");$("#div_modal_add_channel_success").css("display","none");$("#modal_add_channel").modal({closable:!0,onDeny:function(){$("#frm_add_channel_name").val("");$("#frm_add_channel_url").val("")},onApprove:function(){solid_channels__addChannels($("#frm_add_channel_name").val().trim().split(" ").join(""),$("#frm_add_channel_url").val().trim());$("#frm_add_channel_name").val("");$("#frm_add_channel_url").val("")}}).modal("show")}
function modals__manage_channels_show(){$("#modal_manage_channels").modal({closable:!0,onDeny:function(){},onApprove:function(){}}).modal("show")}function modals__preferences_show(){$("#modal_preferences").modal({closable:!0,onDeny:function(){},onApprove:function(){preferences__done()}}).modal("show")}function navigation__chatterModeClicked(){}function navigation_tabs_onclick(a){}function navigation__findOutMore(){openwindow("https://github.com/scenaristeur/solidarity")}
function preferences__show(){$("#cb_preferences_use_sounds").prop("checked",g.preferences.sounds);0==g.preferences.date_format?$("#cb_preferences_timeformat_0").prop("checked",!0):$("#cb_preferences_timeformat_0").prop("checked",!1);1==g.preferences.date_format?$("#cb_preferences_timeformat_1").prop("checked",!0):$("#cb_preferences_timeformat_1").prop("checked",!1);modals__preferences_show()}
function preferences__done(){g.preferences.sounds=$("#cb_preferences_use_sounds").is(":checked");$("#cb_preferences_timeformat_0").is(":checked")?g.preferences.date_format=0:g.preferences.date_format=1;cookie.set("Preferences",JSON.stringify(g.preferences))}function preferences__get(){};